use ::components/ui/unbound/UIWidget.bbj::UIWidget
use ::components/ui/bound/UIComponent.bbj::UIComponent
use ::components/bl/BusinessComponent.bbj::BusinessComponent
use ::components/db/DataRow.bbj::DataRow
use ::components/db/DataRow.bbj::DataField
use ::components/ui/bound/grid/NavigationGridComponent.bbj::NavigationGridComponent


class public NavigationToolbarComponent extends UIComponent implements UIWidget


    field private BBjNumber IsFormLocked
    field private BBjVector ControlList!


    field private BBjToolButton BtnSearch!
    field private BBjToolButton BtnFirst!
    field private BBjToolButton BtnPrev!
    field private BBjToolButton BtnNext!
    field private BBjToolButton BtnLast!
    
    field private BBjMenuItem MenuSearch!
    field private BBjMenuItem MenuFirst!
    field private BBjMenuItem MenuPrev!
    field private BBjMenuItem MenuNext!
    field private BBjMenuItem MenuLast!
    
    field private BBjNumber ShowButtonSearch=1
    field private BBjNumber ShowButtonFirst=1
    field private BBjNumber ShowButtonPrev=1
    field private BBjNumber ShowButtonNext=1
    field private BBjNumber ShowButtonLast=1


    method public NavigationToolbarComponent (BBjChildWindow cw!)

        #super!(cw!)
        #initialize()

    methodend

    method public NavigationToolbarComponent (BBjWindow wnd!, BBjNumber id, BBjNumber x, BBjNumber y, BBjNumber w, BBjNumber h)

        #super!(wnd!,id,x,y,w,h)
        #initialize()

    methodend


    method private void initialize()
    
        #getLaf().prepareWindow(#getWnd())
        rem #getLaf().setStyle(#getWnd(), "ShadowedPanel")

        imgMan! = BBjAPI().getSysGui().getImageManager()
        offs=5
        stepping=22

        #BtnSearch! = #getWnd().addToolButton(99,offs,0,22,22,"")
        #BtnSearch!.setImage(imgMan!.loadImageFromBytes(#getIconSearch()))
        #BtnSearch!.setCallback(BBjAPI.ON_TOOL_BUTTON_PUSH,#this!,"onBtnSearch")
        #BtnSearch!.setToolTipText(#super!.getTranslator().getTranslation("TOOLTIP_SEARCH"))
        #BtnSearch!.setOpaque(0)
        offs=offs+stepping+5
        
        #BtnFirst! = #getWnd().addToolButton(100,offs,0,22,22,"")
        #BtnFirst!.setImage(imgMan!.loadImageFromBytes(#getIconFirst()))
        #BtnFirst!.setCallback(BBjAPI.ON_TOOL_BUTTON_PUSH,#this!,"onBtnFirst")
        #BtnFirst!.setToolTipText(#super!.getTranslator().getTranslation("TOOLTIP_FIRST"))
        #BtnFirst!.setOpaque(0)
        offs=offs+stepping

        #BtnPrev! = #getWnd().addToolButton(101,offs,0,22,22,"")
        #BtnPrev!.setImage(imgMan!.loadImageFromBytes(#getIconPrev()))
        #BtnPrev!.setCallback(BBjAPI.ON_TOOL_BUTTON_PUSH,#this!,"onBtnPrev")
        #BtnPrev!.setToolTipText(#super!.getTranslator().getTranslation("TOOLTIP_PREV"))
        #BtnPrev!.setOpaque(0)
        offs=offs+stepping

        #BtnNext! = #getWnd().addToolButton(102,offs,0,22,22,"")
        #BtnNext!.setImage(imgMan!.loadImageFromBytes(#getIconNext()))
        #BtnNext!.setCallback(BBjAPI.ON_TOOL_BUTTON_PUSH,#this!,"onBtnNext")
        #BtnNext!.setToolTipText(#super!.getTranslator().getTranslation("TOOLTIP_NEXT"))
        #BtnNext!.setOpaque(0)
        offs=offs+stepping

        #BtnLast! = #getWnd().addToolButton(103,offs,0,22,22,"")
        #BtnLast!.setImage(imgMan!.loadImageFromBytes(#getIconLast()))
        #BtnLast!.setCallback(BBjAPI.ON_TOOL_BUTTON_PUSH,#this!,"onBtnLast")
        #BtnLast!.setToolTipText(#super!.getTranslator().getTranslation("TOOLTIP_LAST"))
        #BtnLast!.setOpaque(0)
        offs=offs+stepping


    methodend

    method public void setSize(BBjNumber w, BBjNumber h)

        #super!.setSize(w,h)

    methodend

    method public void setVisible(BBjNumber v)

        #super!.setVisible(v)

    methodend

    method public void setBC(BusinessComponent bc!)

        #super!.setBC(bc!)

    methodend

    method public void setShowButtonSearch(BBjNumber fShow)
    
        #ShowButtonSearch = fShow
        #BtnSearch!.setVisible(fShow)
    
    methodend

    method public void setShowButtonFirst(BBjNumber fShow)
    
        #ShowButtonFirst = fShow
        #BtnFirst!.setVisible(fShow)
    
    methodend
    
    method public void setShowButtonPrev(BBjNumber fShow)
    
        #ShowButtonPrev = fShow
        #BtnPrev!.setVisible(fShow)
    
    methodend

    method public void setShowButtonNext(BBjNumber fShow)
    
        #ShowButtonNext = fShow
        #BtnNext!.setVisible(fShow)
    
    methodend
    
    method public void setShowButtonLast(BBjNumber fShow)
    
        #ShowButtonLast = fShow
        #BtnLast!.setVisible(fShow)
    
    methodend
        
        


    method public void onBtnFirst(BBjEvent ev!)

        if #getBC().canSelectionChange(0,#this!) then

            v!=new BBjVector()
            v!.addItem(0)
            #getBC().setSelection(v!)

        fi

    methodend

    method public void onBtnPrev(BBjEvent ev!)

        if #getBC().canSelectionChange(0,#this!) then

            if #getBC().getSelection().size()>0 then
                recno = #getBC().getSelection().getItem(0)
            fi

            recno=max(0,recno-1)

            v!=new BBjVector()
            v!.addItem(recno)
            #getBC().setSelection(v!)

        fi

    methodend

    method public void onBtnNext(BBjEvent ev!)

        if #getBC().canSelectionChange(0,#this!) then

            if #getBC().getSelection().size()>0 then
                recno = #getBC().getSelection().getItem(0)
            else
                recno=-1
            fi


            if recno < #getBC().size()-1 then
                recno=max(0,recno +1)
                #getBC().prepareResultSet(recno,recno+2)
                v!=new BBjVector()
                v!.addItem(recno)
                #getBC().setSelection(v!)
            fi

        fi


    methodend


    method public void onBtnLast(BBjEvent ev!)

        if #getBC().canSelectionChange(0,#this!) then

            v!=new BBjVector()
            s=#getBC().size()
            v!.addItem(s-1)
            #getBC().prepareResultSet(s-50,s)
            #getBC().setSelection(v!)

        fi

    methodend

    method public void onBtnSearch(BBjEvent ev!)

                
        ng1! = new NavigationGridComponent(null(),101,10,10,1000,350)
        ng1!.setBC(#getBC())
        ng1!.setShowToolbar(1)
        ng1!.setMultipleSelection(0)

        #getBC().setQueryFilter(new java.util.HashMap())
        #getBC().refresh(1)

        ret= ng1!.doModal()
        
        v! = #getBC().getSelection().clone()
         
        if ret then
                
        else
                #getBC().setSelection(v!)
        fi

    methodend

    rem callback functions for Business Component
    rem /**
    rem * Method setEditing
    rem * invoked from BusinessComponent if a UI component started editing a record in the resultset
    rem * @param BBjNumber isEditing: -1 = i
    rem */
    method public void setEditing(BBjNumber isEditing)

        #getWnd().setEnabled(!isEditing)
        
        if #MenuSearch! <> null() then
            #MenuSearch!.setEnabled(!isEditing)
        fi

    methodend

    method protected BBjString getIconFirst()
        methodret $89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000003164944415478DA7D537D2CD4611C3FF187356BBDA0554BD324239A97B3CAB08A22ADAD72723599D26122CE7B89BC4EB4A998A208719CC391F34EE79DDBAA6BB8EC50EECC0D39FA837F6AB64FCFEFD16AABE6D93E7BF67D7E9FCFE7FBF93EFB3D2CD6FF967D92178B9D54C0724892117CA73B5333E79B2EDB042342AA37E755C057A0005FAA4568DB0A7C5E7F8573F6284C0245D87A3ABB81E59C69F4AFD82ED96CBBDBC385902625C23ABE2048A246B0E42BBC4B55E09469E04370FEF934F6F244D0714D9F67B9A499FE117338BA5B1C933FC41351CE38E02754C332B60D16FC661C0811C1F456190EDEAE854D5C1BAC625AB1CBAF143A6E59EF599C1A5DAAD765A75CB3E68B912107D6D7D76170A588920F4788611926C0C0D80CCC42ABE094FA16C71E74C33EB113DBB945D0F5C8F1A506FA4EE91DD7AAA710DE01ACAEAEC2D0AF18D6D18DB08B126258A1C6F2F2328EF085B08AAC864578156CA2C5B0220D0D2E3F69DF4870226539B4F51B026ABF51B20989CC8E1561E4938AD65AAD168B8B8BD0683450ABD5381A5D0397F46E1872F39736EEC029955CD81A2CA324585A5AC261125BD0334E854AA5120A850272B91C32990C2A950A4EF71BE0F578107BFC9FFDA07ABD93992B4713BA60EC5F82F9F979DAC13DAD89CCFE99D64CE7D9D9592A66E09ED98C4BF9C3300B2ED65203C30BB9FDFB8384D877B39412D90975F02E1802E76917FA3E4ED2D8012503F07FD907DF0229B88583B898D70F768CA08F1A3884BC8AD971F5059D9DE9703C518CC0CA31F02AE4082CE9472F31E1D7C991DE3387C4F619448A277136AB05DC4792286AF065716DF7B6CB4F94C67E85F4B6CF64758227184754E314A21B2770A75A860CE90CB2FA3548EA54C3BF78186E29B513D30BABC6D400804E5AE5C839236EBED636AE1E3E85EF6802A613D331F5ED2C1533096E958FC033A3415BDCADF06474BF7F4652E8BF914D9FB20E2B973AC4D7D21979825192621271924944D48DE1FA8B5E709FB64A7B1573A718FE3FCF811CEA111CBA91D71EEF7C5738703CA16AC53559048F0CF18A4F6ECBC0BDEAA178E63BC3DBF45112C24E0273023B02C75F3B53EFFC9BFB1313EB25CFF0EF32F00000000049454E44AE426082$
    methodend

    method protected BBjString getIconPrev()
        methodret $89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000003094944415478DA7D536B489351189EE90F89082B2D2AAC0495C054D429A5A964469A1194295B5656784DCC4B9AB372DEC534344B342FF37E9FD75ADE757977A10D946173A24E1D73B54D24FFD49FA7EF3B464546071E1EDEF33DCFF39EF3F21D06E35FCB8EEBC5B0E71630985C11856F84E99ADEFFEFB28937A244ADE6413560D549102D5423AC5B0BDFEACF70CE9AC1B1003E769FCF6A67386718ED34DB269A1AB83F5B0F7D2B4578EF228205720476A870BD6219AC9A75F8562A70F9F5028E04F1A1E39AA664B8A49AFC36FBF8E8EE7248FCC81957A0661388E853E2D8FD161CBD5386E3A17C58C575C38AD34DD822B60B076E5540C73D739AE1D3A44BFCBAF6C97E96D16D2857038F8635300EE1C324B012E312394E84D4C2296510675385844F270DC0EE691F0CD8C5D0F5C86691007DA7B45EBF0619B2E700BB844198065713F3E6E6264E3EA8874554034E453712A66BAB983658500DF778E7F56C9FC0315913D6B581B861C02CB416A3B34BD8D8D88056AB8546A3815AAD864AA58242A1805C2E87754C135CD20660C8CEFFB23D03A7148408B6C0A4BAF3BAC5C42093C908A45229241209C46231442211969797E194D00EAF176338EC5FF89DF8F5CE6568ADE3FB712A5600EBC80608C532D2918652A9249D5756568899C6858C77B8963F01D3109E9A04185EC91D310E6E2403724CEA8133B71D83D352ACAEAE825520847FE930EE968D12A66B76D118AEBE1A817D6CDD3009608696C7EEBB5142A6EC913306AF9C215CCEEE42FFD41C82AA45487BBF86CC1105E1A73D4B886A9BC7C5CC4EB09F0B1E928045D5D6A1BDDE79D293117C78E68E83553C8D9BA51FE05728444CC71C31E78A5484B97D72F8F326E09EDC3CB7B0FEF5200900A0935A3B79C9889DAFB6896B856FD114026A6711D1F28974FCF304815593F04C6F57F306249EB4EFD7CF4815FA6F440B6E96E1554226A799DC31A86E060F3BE61127984764CB2C6E970C81FDB24B38245973A3F53B9E03B5A947C1ECDEAB1E8EF3E3C6D133F1F55AD7443E3CD2DBB4BEB99DA34F1AC639F4775AF7DF474909F65330A7604BC1E127D3F5FEBFB53F0024A52938232A5C790000000049454E44AE426082$
    methodend

    method protected BBjString getIconNext()
        methodret $89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000003084944415478DA7D536B489361149ECD1F1111655A141594169659949B5DCC2213D20A214CD90A5D546A266A5EE74A679A8A696917B1D4CC5573599BD36CA9F3D2725E52C855EAB06D626D25F3F26D23EA4FFD79FABEB71B64F4C2C3E139DF799E73DEC3F7B258FF3A3EE2832CAEB89CC5110FD0F84A22C399FC7FCF16911B5DA45C172D054FA647B286425CAB1DE1F7A7E15F348455A7E498B7AFA891E55FE0365BBC35DB6361E0A5C9D82706C4B78D234665C669D5348E48DE83279D44E81D0B0EDD1AC3F268399CF6E45959BB2FAEFE230E0B63CFF1CDD665F44D40FA09486CB762437A2B3C939FC22BAD056BE214581D759744862F8E90C029B0709015F6884DF46C6ECE31EFE406D45040BAD686F5A92DD8246C854F663BB65FE884FB19197A87DFC13B51868DA98F497E21BF12ECA0621E3198EB97D776ACCE84E251C05BA8866B4435569C94C03D560ACF8407F04AAA83CD66A34DC6C1152AC039474F46379C1F7A4DFD63829D39B6B81607C403C012410D29B6DBED70381C24329CA2284C4D4D41FBCA885D994A6CCB6A862BBF6CE6C70EFC72E9857DC1FEAB6F48E7999919984CA6DF30180CD0EBF5D0E974B0582C9076E8B03DAB09CB0437BF11BDF3DE02FB665107B91B33B6D56A25DD7E81E113131344ACD1BD4548712B0E5E790E8FD3D51431700D29ED5E19F3902CCC47D404AEA81E01792A8494B48157AE81E0B61666B319DAD706445674E1B8E4250EDFE806374DA625069CD89AB44547ABE097FB0C4125BD08AF788953B5C3486A302253FD0E098F74D0BE3122AEB61F49CA1192DF5FD80CFE65550A31189FFAB27441E8358367A21CC1A57DE0550E225A368294C72688DBCD10AB4D48570E92C87041F50B04E62846C7263F2F2106009C2ED6F61F70E397515B84CA5913E43DFF8882AE0F2446DDEB47707E2355DDA90F6674BF7F469ACC6D1A180BF08EBFA7E16428C81DA36543F414460855469CAD1F46645517F8D75B345DFA8F014CFDACE740279D69AC3D71439DE17FEE61CF0ED103FB9E6C3982F21BECE1A5CD3DE7EBFA3298EF4CDD7F1F255DE042631D8DAD347C7F4686BBFC5DFB1D38D9286AA3BF47A30000000049454E44AE426082$
    methodend

    method protected BBjString getIconLast()
        methodret $89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF61000003344944415478DA7D936D4CD35714C6CBF08399C6A8131D44DD661C315134289009419D920063D97CA35A0DEAD01518310A04810D6160219DCE31055F500988B48245DEE4451028B50892491501115A0597928AB425647ED9BEFCF6FFFF3598A8F1244F4ECEB9CFF39C7B6FEE95C9DE176BD2C264BE6967653E695D02FE95B2588BFD0F86778A9B40AAF05496B053DB4FBCDE4EEC4D27F22B2F083CFE90C507747CBCE978952C30DBED5DF1EAF4A5B3837E7B1E736390834D4FD95F354C74ED0BB6178D08B022BF3CCAB7E72D782875B8AC57D964EB8E7DF1461C1EEEFA915FBA29B963949249D857FE379F465CC27DBF9685CA52DC23F2F92CA68C954937599ED8C0271145B804A9BB65E1D75C25BDAB6FC66EAFF84A0AED70E4B68319F27CDA7B47581C79098FC8428C3D4FF08C2E624542255FFDDAC29AD45BCC565CC035E4C44EC9607A80AA6977A9994403781CD03233FC0C93939374F48DB0EAB086C7C3A3828905EF780D7EA9756CC836B05C183873DBA9C6573BF0CF70C4364CA028B1E17038703A9D4C4C4C48B9B36F98CDEA1A5A4D43184C83F8A794B149DDCA3A550BF31479E3AFEE202053B8B0972C892D677C7C1CB3D93C05B1D6197B09CEAAE6AF3E33579ABBD9905947D89F7770DF7BEE3F493FEDEB6CE7AA946666ED388BCD66636C6C6C0AC61E33BB729BA8EFEA47DFFD88EF4FD4A1B8D0C5D6BC4E964617D8258379DFE518174595B1E4A7AB7CAE2CC42B4E83D56AA5B57B801DA71B69EF19A4EDFE6322CE3713A53111AB1B604BAE11DF44ED6DC9C027A63071CEAE8B0464B612F2C71DFC8F5651DFD9CB96930DEC2B30A2370D105564E048CD23521B8789AB1C22585D8FE2F7DA04C9E0E9D8CB05B3B69D1A5C764847684E076127DB085655A32C311157D12789339B2DA88DA3A4DD7AC6DE824E8232CA072CCFFF992F19002EC73477BF7153E4D9BD932A90E7DFE387E207D224716246CB3349AC6AB3F263F15D42B3AAEC052DFDA1A26EEA310AC5F49A2ECB46AF83C57A9FE472E98C4AED4312AA8748AA1DE2F0F55EF65C34A038DDA037F45B378AFC77BE83D09C26E0CBC8DCC6E4C09FCBDAD7A65C75AE4FD7119255E994E7D4B7FF52DA912CAE8BBC0F7E4A81305780A780D502FC5E67B19EFB36F77F1F23263059DBE7E80000000049454E44AE426082$
    methodend
    
    method protected BBjString getIconSearch()
        methodret $89504E470D0A1A0A0000000D49484452000000100000001008060000001FF3FF610000019B4944415478DAAD8FBF4B425114C785906A942CC5A1D9740843227350EC69F508C4F4BD873C032921B506A1C5274238D5E8A4829635D8E0E8620D827F414DD9CFC5A9BF42BEDD7B5348F48950070E5F38DFEFFDDC73349AFFAC5C2E874AA582743A8D69E623653418B06EB7C36AB10C82332AF3F1655B5DC5692201311482D7EB89FAB8AD2FAABFE7238F388E5B3ECF66711C8B61736303F373733404ABD98CAB7299E9389FF43203785CAE839BEB6BB4DB6DE4F3791C1EC52088220BF9FD7EA69F1F1F43BEC964A2F3E80FC0EDAE3E349BB8271D222B1A8C46088208835E8FBB5A8D290554C927D4DF0F06B1665BA3802A03ECF17CF7E9F111B7B737D8D9DDC5827E910004CC6AB528140A4CDFDFDE502A15996F5EB180E7790AE832801C0EA3F3FC8C46A3012593811C892044007475A97F8A9ACF00C9781C67A914F6087D89ACDB3706FDBAEDF34DF259E1A5D341BD5E47327942EE1486CC6932CCBCBCB8C08AC53A11A096F91B409665B45A2D4892049D4E0787C301A7D339049898A166AFD743B15844201080A2286301AA1935BA9DE3FD762F7F4075D206DF55E56ADBFD23D8070000000049454E44AE426082$
    methodend

    method public void setupMenu(BBjMenu editMenu!)
        
        imgMan! = BBjAPI().getSysGui().getImageManager()
        #MenuSearch! = editMenu!.addMenuItem(-1,#super!.getTranslator().getTranslation("MENUITEM_SEARCH"))
        #MenuSearch!.setImage(imgMan!.loadImageFromBytes(#getIconSearch()))
        #MenuSearch!.setCallback(BBjAPI.ON_MENU_ITEM_SELECT,#this!,"onBtnSearch")

        editMenu!.addSeparator()

        imgMan! = BBjAPI().getSysGui().getImageManager()
        #MenuFirst! = editMenu!.addMenuItem(-1,#super!.getTranslator().getTranslation("MENUITEM_FIRST"))
        #MenuFirst!.setImage(imgMan!.loadImageFromBytes(#getIconFirst()))
        #MenuFirst!.setCallback(BBjAPI.ON_MENU_ITEM_SELECT,#this!,"onBtnFirst")

        imgMan! = BBjAPI().getSysGui().getImageManager()
        #MenuPrev! = editMenu!.addMenuItem(-1,#super!.getTranslator().getTranslation("MENUITEM_PREV"))
        #MenuPrev!.setImage(imgMan!.loadImageFromBytes(#getIconPrev()))
        #MenuPrev!.setCallback(BBjAPI.ON_MENU_ITEM_SELECT,#this!,"onBtnPrev")
        
        imgMan! = BBjAPI().getSysGui().getImageManager()
        #MenuNext! = editMenu!.addMenuItem(-1,#super!.getTranslator().getTranslation("MENUITEM_NEXT"))
        #MenuNext!.setImage(imgMan!.loadImageFromBytes(#getIconNext()))
        #MenuNext!.setCallback(BBjAPI.ON_MENU_ITEM_SELECT,#this!,"onBtnNext")
        
        imgMan! = BBjAPI().getSysGui().getImageManager()
        #MenuLast! = editMenu!.addMenuItem(-1,#super!.getTranslator().getTranslation("MENUITEM_LAST"))
        #MenuLast!.setImage(imgMan!.loadImageFromBytes(#getIconLast()))
        #MenuLast!.setCallback(BBjAPI.ON_MENU_ITEM_SELECT,#this!,"onBtnLast")
        
   
    methodend

classend













